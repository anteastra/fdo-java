<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>INTUIT.ru::Интернет-Университет Информационных Технологий</title>
<link rel="shortcut icon" href="http://www.intuit.ru/favicon.ico">


<META http-equiv="Pragma" CONTENT="no-cache">
<META http-equiv="Cache-Control" CONTENT="no-cache, must-revalidate">
<META NAME="Pragma" CONTENT="no-cache">
<META NAME="Cache-Control" CONTENT="no-cache">
<link href="../../../ssi/style.css" type="text/css" rel="stylesheet">
</head>
<body leftmargin="0" topmargin="6" marginheight="6" marginwidth="0" bgcolor="white">

<!-- header -->
<!---->
<table border="0" cellpadding="8" cellspacing="0" width="100%">
<tr valign="top">
<td><a href="http://www.intuit.ru/"><img src="../../../img/logo.gif" border="0" width="285" height="52" alt="Интернет Университет информационных технологий"></a></td>
<!---->
</tr>
</table>

<!-- /header -->

<!-- /menu -->
<table border="0" cellpadding="" cellspacing="6" width="100%">
<tr>
<td align="center" class="menu">
	<table border="0" cellpadding="0" cellspacing="0" background="" height="31">
	<tr>
	<td><a href="http://www.intuit.ru/speciality/" class="menu">Учебные программы</a></td>
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/all_departments.html" class="menu">Кафедры</a></td>	
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/all_courses.html" class="menu">Все курсы</a></td>	
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/syllabus.html" class="menu">Расписание</a></td>		
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/shop/" class="menu">Учебники</a></td>		
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/news.html" class="menu">Новости</a></td>		
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/department/forum/" class="menu">Форум</a></td>
<!--
	<td><img src="../../../img/separator.gif" width="2" height="18" border="0" hspace="7"></td>
	<td><a href="http://www.intuit.ru/help/" class="menu">Помощь</a></td>		
-->
	</tr>
	</table>	

</td>
</tr>
</table>
<!-- /menu -->


<table border="0" cellpadding="0" cellspacing="0" width="100%" height="73">
<tr valign="top">
<td width="6"><img src="../../../img/empty.gif" width="6"></td>
<td width="180">
	<!-- leftcolumn -->
	<table border="0" cellpadding="2" cellspacing="0" background="" width="100%">

		<tr valign="middle">
	<td class="orang" height="24">&nbsp;&nbsp;Лекции</td>
	</tr>
	<tr>
	<td>
		<table border="0" cellpadding="0" cellspacing="0">

		<tr valign=top>

		<td colspan=3>
<a href="../index.html" class="spec">Программирование на Java</a>


</td>
		</tr>
<tr valign=top><td colspan="3" height="6"><img src="../../../img/empty.gif" width="1" height="6"></td></tr>

		<tr valign=top>

		<td class="llecture">1.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../1/1.html" class="llecture">Что такое Java? История создания</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">2.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../2/1.html" class="llecture">Основы объектно-ориентированного...</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">3.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../3/1.html" class="llecture">Лексика языка</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">4.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../4/1.html" class="llecture">Типы данных</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">5.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../5/1.html" class="llecture">Имена. Пакеты</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">6.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../6/1.html" class="llecture">Объявление классов</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">7.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../7/1.html" class="llecture">Преобразование типов</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">8.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../8/1.html" class="llecture">Объектная модель в Java</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">9.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../9/1.html" class="llecture">Массивы</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">10.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../10/1.html" class="llecture">Операторы и структура кода. Искл...</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">11.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../11/1.html" class="llecture">Пакет java.awt</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">12.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../12/1.html" class="llecture">Потоки выполнения. Синхронизация</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">13.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../13/1.html" class="llecture">Пакет java.lang</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">14.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../14/1.html" class="llecture">Пакет java.util</a>
</td>
		</tr>




		<tr valign=top>

		<td class="llecture">15.</td>
		<td>&nbsp;</td>
<td class="llecture">

Пакет java.io



</td>
		</tr>




		<tr valign=top>

		<td class="llecture">16.</td>
		<td>&nbsp;</td>
<td class="llecture">

<a href="../16/1.html" class="llecture">Введение в сетевые протоколы</a>
</td>
		</tr>






<tr valign=top><td colspan="3" height="6"><img src="../../../img/empty.gif" width="1" height="6"></td></tr>
		<tr valign=top>

		<td class="llecture">&nbsp;</td>
<td>&nbsp;</td>

		<td class="llecture"><a href="http://www.intuit.ru/department/pl/javapl/class/examination/" class="llecture">Экзамен</a></td>
		</tr>
		<tr valign=top>

		<td class="llecture">&nbsp;</td>
<td>&nbsp;</td>

		<td class="llecture"><a class="llecture_red" href="http://www.intuit.ru/department/pl/javapl/class/examination_extern/">Сдать экзамен экстерном</a></td>
		</tr>

<tr valign=top><td colspan="3" height="6"><img src="../../../img/empty.gif" width="1" height="6"></td></tr>

		<tr valign=top>

		<td class="llecture">&nbsp;</td>
<td>&nbsp;</td>

		<td class="llecture"><a href="../lit.html" class="llecture">Литература</a></td>
		</tr>





		<tr valign=top>

		<td class="llecture">&nbsp;</td>
<td>&nbsp;</td>

		<td class="llecture"><a href="../keywords.html" class="llecture">Предметный указатель</a></td>
		</tr>



		<tr valign=top>

		<td class="llecture">&nbsp;</td>
<td>&nbsp;</td>

		<td class="llecture"><a href="../examples.html" class="llecture">Примеры</a></td>
		</tr>


		</table><br>
	</td>
	</tr>


	

	<tr valign="middle">
	<td class="orang" height="24">&nbsp;&nbsp;Общение</td>
	</tr>
	<tr>
	<td>
		<table border="0" cellpadding="0" cellspacing="0">

		<tr valign=top>
		<td><img src="../../../img/arrow.gif" border="0" width="6" height="7" hspace="5" vspace="5"></td>
		<td><a href="http://www.intuit.ru/department/pl/javapl/class/classmates/" class="spec">однокурсники</a></td>
		</tr>
		

		<tr valign=top>
		<td><img src="../../../img/arrow.gif" border="0" width="6" height="7" hspace="5" vspace="5"></td>
		<td><a href="http://www.intuit.ru/department/pl/javapl/forum/" class="spec">форум по курсу</a></td>
		</tr>

		<tr valign=top>
		<td><img src="../../../img/arrow.gif" border="0" width="6" height="7" hspace="5" vspace="5"></td>
		<td><a href="http://www.intuit.ru/department/pl/javapl/class/question_for_lector/" class="spec">вопрос преподавателю</a></td>
		</tr>

		<tr valign=top>
		<td><img src="../../../img/arrow.gif" border="0" width="6" height="7" hspace="5" vspace="5"></td>
		<td><a href="http://www.intuit.ru/department/pl/javapl/class/opinions/" class="spec">мнения о курсе</a></td>
		</tr>

		<tr valign=top>
		<td><img src="../../../img/arrow.gif" border="0" width="6" height="7" hspace="5" vspace="5"></td>
		<td><a href="http://www.intuit.ru/department/pl/javapl/class/rating/" class="spec">рейтинг выпускников</a></td>
		</tr>


		</table><br>
	</td>
	</tr>



<tr><td height="1"><a href="../robot.html"><img src="../../../img/empty.gif" width="1" height="1" border="0"></a></td></tr>

	</table>

	<!-- #include virtual="~/inc/leftcolumn.html" -->
	<!-- /leftcolumn -->	
</td>
<td width="6"><img src="../../../img/empty.gif" width="6"></td>
<td width="1" class="gray"><img src="../../../img/empty.gif"></td>
<td width="6"><img src="../../../img/empty.gif" width="6"></td>
<td>
	<!-- content -->
	<table border="0" cellpadding="0" cellspacing="0" width="100%">
	<tr><td class="head" colspan=2>Программирование на Java</td></tr>
<tr><td colspan=2 height="4"><img src="../../../img/empty.gif" width="1" height="4"></td></tr>
	<tr><td class="orang" height="1" colspan=2><img src="../../../img/empty.gif" width="1" height="1"></td></tr>
	<tr><td height="8" colspan=2><img src="../../../img/empty.gif" width="1" height="8"></td></tr>




<tr>
<td colspan="2" align=left class="headsub">Лекция #15: Пакет java.io</td>
</tr>

<tr><td height="6" colspan=2><img src="../../../img/empty.gif" width="1" height="8"></td></tr>
<tr><td class="orang" height="1" colspan=2><img src="../../../img/empty.gif" width="1" height="1"></td></tr>
<tr><td height="2" colspan=2><img src="../../../img/empty.gif" width="1" height="2"></td></tr>


<tr>

<td align=left><font class="rtitle">Страницы:</font>


<font class="rtitle">1</font>

<font class="stitle">|</font>


<a class="rtitle" href="2.html">2</a>
<font class="stitle">|</font>


<a class="rtitle" href="3.html">3</a>
<font class="stitle">|</font>


<a class="rtitle" href="4.html">4</a>
<font class="stitle">|</font>


<a class="rtitle" href="http://www.intuit.ru/department/pl/javapl/15/test/">вопросы</a> <font class="stitle">|</font> 
<a class="rtitle" href="2.html"><b>&raquo;</b></a>
</td>
<td align=right><font class="stitle">|</font>
<a href="http://www.intuit.ru/department/pl/javapl/15/javapl_15.html" class="rtitle" target="_blank">HTML для печати</a>




</td>

</tr>


	<tr><td height="2" colspan=2><img src="../../../img/empty.gif" width="1" height="2"></td></tr>
<tr><td align="center" class="orang_light" colspan="2">
&nbsp;
<font class="rtxt">Если Вы заметили ошибку на этой странице - <a class="llecture_red" target="_blank" href="http://www.intuit.ru/help/askform.xhtml?course=57&url=http://www.intuit.ru/department/pl/javapl/15/1.html">сообщите нам.</a></font>
&nbsp;
</td></tr>

	<tr><td height="8" colspan=2><img src="../../../img/empty.gif" width="1" height="8"></td></tr>
	<tr><td colspan=2>
<h3 >Система ввода/вывода. Потоки данных (stream)</h3>
        
        <p >Подавляющее большинство программ обменивается данными с внешним миром. Это, безусловно, делают любые сетевые приложения – они передают и получают информацию от других компьютеров и специальных устройств, подключенных к сети. Оказывается, можно точно таким же образом представлять обмен данными между устройствами внутри одной машины. Так, например, программа может считывать данные с клавиатуры и записывать их в файл, или же наоборот - считывать данные из файла и выводить их на экран. Таким образом, устройства, откуда может производиться считывание информации, могут быть самыми разнообразными – файл, клавиатура, входящее сетевое соединение и т.д. То же касается и устройств вывода – это может быть файл, экран монитора, принтер, исходящее сетевое соединение и т.п. В конечном счете, все данные в компьютерной системе в процессе обработки передаются от устройств ввода к устройствам вывода. </p>
        <p >Обычно часть вычислительной платформы, которая отвечает за обмен данными, так и называется – система ввода/вывода. В Java она представлена пакетом <span class="texample">java.io</span> (<span class="texample">input/output</span>). Реализация системы ввода/вывода осложняется не только широким спектром источников и получателей данных, но еще и различными форматами передачи информации. Ею можно обмениваться в двоичном представлении, символьном или текстовом, с применением некоторой кодировки (только для русского языка их насчитывается более 4 штук), или передавать числа в различных представлениях. Доступ к данным может потребоваться как последовательный (например, считывание HTML-страницы), так и произвольный (сложная работа с несколькими частями одного файла). Зачастую для повышения производительности применяется буферизация. </p>
        <p ><a name="keyword-context.1"></a><a name="keyword-context.2"></a>
		В Java для описания работы по вводу/выводу используется специальное понятие <span class="keyword">поток данных</span> (<span class="keyword">stream</span>). <span class="keyword">Поток данных</span> связан с некоторым источником, или приемником, данных, способным получать или предоставлять информацию. Соответственно, <span class="keyword">потоки</span> делятся на входящие – читающие данные и выходящие – передающие (записывающие) данные. Введение концепции <span class="keyword">stream</span> позволяет отделить основную логику программы, обменивающейся информацией с любыми устройствами одинаковым образом, от низкоуровневых операций с такими устройствами ввода/вывода. </p>
        <p >В Java <span class="keyword">потоки</span> естественным образом представляются объектами. Описывающие их классы как раз и составляют основную часть пакета <span class="texample">java.io</span>. Они довольно разнообразны и отвечают за различную функциональность. Все классы разделены на две части – одни осуществляют ввод данных, другие – вывод. </p>
        <p >Существующие стандартные классы помогают решить большинство типичных задач. Минимальной "порцией" информации является, как известно, бит, принимающий значение 0 или 1 (это понятие также удобно применять на самом низком уровне, где данные передаются электрическим сигналом; условно говоря, 1 представляется прохождением импульса, 0 – его отсутствием). Традиционно используется более крупная единица измерения – байт, объединяющая 8 бит. Таким образом, значение, представленное одним байтом, находится в диапазоне от 0 до 2<sup>8</sup>-1=255, или, если использовать знак, – от -128 до +127. Примитивный тип <span class="texample">byte</span> в Java в точности соответствует последнему – знаковому диапазону. </p>
        <p >Базовые, наиболее универсальные, классы позволяют считывать и записывать информацию именно в виде набора байт. Чтобы их было удобно применять в различных задачах, <span class="texample">java.io</span> содержит также классы, преобразующие любые данные в набор байт. </p>
        <p >Например, если нужно сохранить результаты вычислений – набор значений типа <span class="texample">double</span> – в файл, то их можно сначала превратить в набор байт, а затем эти байты записать в файл. Аналогичные действия совершаются и в ситуации, когда требуется сохранить объект (т.е. его состояние) – преобразование в набор байт и последующая их запись в файл. Понятно, что при восстановлении данных в обоих рассмотренных случаях проделываются обратные действия – сначала считывается последовательность байт, а затем она преобразуется в нужный формат.</p>
        <p >На <a href="#image.15.1">рисунке 15.1</a> представлены иерархии классов ввода/вывода. Как и говорилось, все типы поделены на две группы. Представляющие входные <span class="keyword">потоки</span> классы наследуются от <span class="texample">InputStream</span>, а выходные – от <span class="texample">OutputStream</span>. </p>
        <p  align="center"><a name="image.15.1"></a><img src="15-1.gif" alt="Иерархия классов ввода/вывода." width="514" height="418"><br><b>Рис. 
            15.1.
            </b> Иерархия классов ввода/вывода.</p> 
        <h4 >Классы InputStream и OutputStream</h4>
            
            <p >
                <span class="texample">InputStream</span> – это базовый класс для <span class="keyword">потоков</span> ввода, т.е. чтения. Соответственно, он описывает базовые методы для работы с байтовыми <span class="keyword">потоками данных</span>. Эти методы необходимы всем классам, которые наследуются от <span class="texample">InputStream</span>. </p>
            <p >Простейшая операция представлена методом <span class="texample">read()</span> (без аргументов). Он является абстрактным и, соответственно, должен быть определен в классах-наследниках. Этот метод предназначен для считывания ровно одного байта из <span class="keyword">потока</span>, однако возвращает при этом значение типа <span class="texample">int</span>. В том случае, если считывание произошло успешно, возвращаемое значение лежит в диапазоне от 0 до 255 и представляет собой полученный байт (значение <span class="texample">int</span> содержит 4 байта и получается простым дополнением нулями в двоичном представлении). Обратите внимание, что полученный таким образом байт не обладает знаком и не находится в диапазоне от -128 до +127, как примитивный тип <span class="texample">byte</span> в Java. </p>
            <p >Если достигнут конец <span class="keyword">потока</span>, то есть в нем больше нет информации для чтения, то возвращаемое значение равно <span class="texample">-1</span>. </p>
            <p >Если же считать из <span class="keyword">потока</span> данные не удается из-за каких-то ошибок, или сбоев, будет брошено исключение <span class="texample">java.io.IOException</span>. Этот класс наследуется от <span class="texample">Exception</span>, т.е. его всегда необходимо обрабатывать явно. Дело в том, что каналы передачи информации, будь то <span class="texample">Internet</span> или, например, жесткий диск, могут давать сбои независимо от того, насколько хорошо написана программа. А это означает, что нужно быть готовым к ним, чтобы пользователь не потерял нужные данные. </p>
            <p >Метод <span class="texample">read()</span> – это абстрактный метод, но именно с соблюдением всех указанных условий он должен быть реализован в классах-наследниках. </p>
            <p >На практике обычно приходится считывать не один, а сразу несколько байт – то есть массив байт. Для этого используется метод <span class="texample">read()</span>, где в качестве параметров передается массив <span class="texample">byte[]</span>. При выполнении этого метода в цикле производится вызов абстрактного метода <span class="texample">read()</span> (определенного без параметров) и результатами заполняется переданный массив. Количество байт, считываемое таким образом, равно длине переданного массива. Но при этом может так получиться, что данные в <span class="keyword">потоке</span> закончатся еще до того, как будет заполнен весь массив. То есть возможна ситуация, когда в <span class="keyword">потоке данных</span> (байт) содержится меньше, чем длина массива. Поэтому метод возвращает значение <span class="texample">int</span>, указывающее, сколько байт было реально считано. Понятно, что это значение может быть от 0 до величины длины переданного массива. </p>
            <p >Если же мы изначально хотим заполнить не весь массив, а только его часть, то для этих целей используется метод <span class="texample">read()</span>, которому, кроме массива <span class="texample">byte[]</span>, передаются еще два <span class="texample">int</span> значения. Первое – это позиция в массиве, с которой следует начать заполнение, второе – количество байт, которое нужно считать. Такой подход, когда для получения данных передается массив и два <span class="texample">int</span> числа – <span class="texample">offset</span> (смещение) и <span class="texample">length</span> (длина), является довольно распространенным и часто встречается не только в пакете <span class="texample">java.io</span>. </p>
            <p >При вызове методов <span class="texample">read()</span> возможно возникновение такой ситуации, когда запрашиваемые данные еще не готовы к считыванию. Например, если мы считываем данные, поступающие из сети, и они еще просто не пришли. В таком случае нельзя сказать, что данных больше нет, но и считать тоже нечего - выполнение останавливается на вызове метода <span class="texample">read()</span> и получается "зависание". </p>
            <p >Чтобы узнать, сколько байт в <span class="keyword">потоке</span> готово к считыванию, применяется метод <span class="texample">available()</span>. Этот метод возвращает значение типа <span class="texample">int</span>, которое показывает, сколько байт в <span class="keyword">потоке</span> готово к считыванию. При этом не стоит путать количество байт, готовых к считыванию, с тем количеством байт, которые вообще можно будет считать из этого <span class="keyword">потока</span>. Метод <span class="texample">available()</span> возвращает число – количество байт, именно на данный момент готовых к считыванию. </p>
            <p >Когда работа с входным <span class="keyword">потоком данных</span> окончена, его следует закрыть. Для этого вызывается метод <span class="texample">close()</span>. Этим вызовом будут освобождены все системные ресурсы, связанные с <span class="keyword">потоком</span>. </p>
            <p >Точно так же, как <span class="texample">InputStream</span> – это базовый класс для <span class="keyword">потоков</span> ввода, класс <span class="texample">OutputStream</span> – это базовый класс для <span class="keyword">потоков</span> вывода. </p>
            <p >В классе <span class="texample">OutputStream</span> аналогичным образом определяются три метода <span class="texample">write()</span> – один принимающий в качестве параметра <span class="texample">int</span>, второй – <span class="texample">byte[]</span> и третий – <span class="texample">byte[]</span>, плюс два <span class="texample">int</span>-числа. Все эти методы ничего не возвращают (<span class="texample">void</span>). </p>
            <p >Метод <span class="texample">write(int)</span> является абстрактным и должен быть реализован в классах-наследниках. Этот метод принимает в качестве параметра <span class="texample">int</span>, но реально записывает в <span class="keyword">поток</span> только <span class="texample">byte</span> – младшие 8 бит в двоичном представлении. Остальные 24 бита будут проигнорированы. В случае возникновения ошибки этот метод бросает <span class="texample">java.io.IOException</span>, как, впрочем, и большинство методов, связанных с вводом-выводом. </p>
            <p >Для записи в <span class="keyword">поток</span> сразу некоторого количества байт методу <span class="texample">write()</span> передается массив байт. Или, если мы хотим записать только часть массива, то передаем массив <span class="texample">byte[]</span> и два <span class="texample">int</span>-числа – отступ и количество байт для записи. Понятно, что если указать неверные параметры – например, отрицательный отступ, отрицательное количество байт для записи, либо если сумма отступ плюс длина будет больше длины массива, – во всех этих случаях кидается исключение <span class="texample">IndexOutOfBoundsException</span>. </p>
            <p >Реализация <span class="keyword">потока</span> может быть такой, что данные записываются не сразу, а хранятся некоторое время в памяти. Например, мы хотим записать в файл какие-то данные, которые получаем порциями по 10 байт, и так 200 раз подряд. В таком случае вместо 200 обращений к файлу удобней будет скопить все эти данные в памяти, а потом одним заходом записать все 2000 байт. То есть класс выходного <span class="keyword">потока</span> может использовать некоторый внутренний механизм для буферизации (временного хранения перед отправкой) данных. Чтобы убедиться, что данные записаны в <span class="keyword">поток</span>, а не хранятся в буфере, вызывается метод <span class="texample">flush()</span>, определенный в <span class="texample">OutputStream</span>. В этом классе его реализация пустая, но если какой-либо из наследников использует буферизацию данных, то этот метод должен быть в нем переопределен. </p>
            <p >Когда работа с <span class="keyword">потоком</span> закончена, его следует закрыть. Для этого вызывается метод <span class="texample">close()</span>. Этот метод сначала освобождает буфер (вызовом метода <span class="texample">flush</span>), после чего <span class="keyword">поток</span> закрывается и освобождаются все связанные с ним системные ресурсы. Закрытый <span class="keyword">поток</span> не может выполнять операции вывода и не может быть открыт заново. В классе <span class="texample">OutputStream</span> реализация метода <span class="texample">close()</span> не производит никаких действий. </p>
            <p >Итак, классы <span class="texample">InputStream</span> и <span class="texample">OutputStream</span> определяют необходимые методы для работы с байтовыми <span class="keyword">потоками данных</span>. Эти классы являются абстрактными. Их задача – определить общий интерфейс для классов, которые получают данные из различных источников. Такими источниками могут быть, например, массив байт, файл, строка и т.д. Все они, или, по крайней мере, наиболее распространенные, будут рассмотрены далее.</p>
        
        <h4 >Классы-реализации потоков данных</h4>
            
            <h5 >Классы ByteArrayInputStream и ByteArrayOutputStream </h5>
                
                <p >Самый естественный и простой источник, откуда можно считывать байты, – это, конечно, массив байт. Класс <span class="texample">ByteArrayInputStream</span> представляет <span class="keyword">поток</span>, считывающий данные из массива байт. Этот класс имеет конструктор, которому в качестве параметра передается массив <span class="texample">byte[]</span>. Соответственно, при вызове методов <span class="texample">read()</span> возвращаемые данные будут браться именно из этого массива. Например: </p>
                <div  class="example"><pre>
byte[] bytes = {1,-1,0};
ByteArrayInputStream in = 
   new ByteArrayInputStream(bytes); 
int readedInt = in.read(); // readedInt=1
System.out.println("first element read is: "
                    + readedInt);
readedInt = in.read();
// readedInt=255. Однако 
// (byte)readedInt даст значение -1

System.out.println("second element read is: "
                   + readedInt);
readedInt = in.read(); // readedInt=0
System.out.println("third element read is: "
                   + readedInt);
</pre></div>
                <p >Если запустить такую программу, на экране отобразится следующее: </p>
                <div  class="example"><pre>
first element read is: 1
second element read is: 255
third element read is: 0 
</pre></div>
                <p >При вызове метода <span class="texample">read()</span> данные считывались из массива <span class="texample">bytes</span>, переданного в конструктор <span class="texample">ByteArrayInputStream</span>. Обратите внимание, в данном примере второе считанное значение равно 255, а не -1, как можно было бы ожидать. Чтобы понять, почему это произошло, нужно вспомнить, что метод <span class="texample">read</span> считывает <span class="texample">byte</span>, но возвращает значение <span class="texample">int</span>, полученное добавлением необходимого числа нулей (в двоичном представлении). Байт, равный <span class="texample">-1</span>, в двоичном представлении имеет вид <span class="texample">11111111</span> и, соответственно, число типа <span class="texample">int</span>, получаемое приставкой 24-х нулей, равно <span class="texample">255</span> (в десятичной системе). Однако если явно привести его к <span class="texample">byte</span>, получим исходное значение. </p>
                <p >Аналогично, для записи байт в массив применяется класс <span class="texample">ByteArrayOutputStream</span>. Этот класс использует внутри себя объект <span class="texample">byte[]</span>, куда записывает данные, передаваемые при вызове методов <span class="texample">write()</span>. Чтобы получить записанные в массив данные, вызывается метод <span class="texample">toByteArray()</span>. Пример: </p>
                <div  class="example"><pre>
ByteArrayOutputStream out = 
   new ByteArrayOutputStream();
out.write(10);
out.write(11);
byte[] bytes = out.toByteArray(); 
</pre></div>
                <p >В этом примере в результате массив <span class="texample">bytes</span> будет состоять из двух элементов: <span class="texample">10</span> и <span class="texample">11</span>. </p>
                <p >Использовать классы <span class="texample">ByteArrayInputStream</span> и <span class="texample">ByteArrayOutputStream</span> может быть очень удобно, когда нужно проверить, что именно записывается в выходной <span class="keyword">поток</span>. Например, при отладке и тестировании сложных процессов записи и чтения из <span class="keyword">потоков</span>. Эти классы хороши тем, что позволяют сразу просмотреть результат и не нужно создавать ни файл, ни сетевое соединение, ни что-либо еще. </p>
            
            <h5 >Классы FileInputStream и FileOutputStream </h5>
                
                <p >Класс <span class="texample">FileInputStream</span> используется для чтения данных из файла. Конструктор такого класса в качестве параметра принимает название файла, из которого будет производиться считывание. При указании строки имени файла нужно учитывать, что она будет напрямую передана операционной системе, поэтому формат имени файла и пути к нему может различаться на разных платформах. Если при вызове этого конструктора передать строку, указывающую на несуществующий файл или каталог, то будет брошено <span class="texample">java.io.FileNotFoundException.</span> Если же объект успешно создан, то при вызове его методов <span class="texample">read()</span> возвращаемые значения будут считываться из указанного файла. </p>
                <p >Для записи байт в файл используется класс <span class="texample">FileOutputStream</span>. При создании объектов этого класса, то есть при вызовах его конструкторов, кроме имени файла, также можно указать, будут ли данные дописываться в конец файла, либо файл будет перезаписан. Если указанный файл не существует, то сразу после создания <span class="texample">FileOutputStream</span> он будет создан. При вызовах методов <span class="texample">write()</span> передаваемые значения будут записываться в этот файл. По окончании работы необходимо вызвать метод <span class="texample">close()</span>, чтобы сообщить системе, что работа по записи файла закончена. Пример: </p>
                <a  name="example.15.1"></a><div  class="example"><span class="objectName">
            Пример 
            15.1.
            
            (<a href="example.15.1.htm" target="_blank" onClick="window.open('example.15.1.htm','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">html</a>,
            <a href="example.15.1.txt" target="_blank" onClick="window.open('example.15.1.txt','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">txt</a>)
            </span></div>
                <p >Результатом работы программы будет: </p>
                <a  name="example.15.2"></a><div  class="example"><span class="objectName">
            Пример 
            15.2.
            
            (<a href="example.15.2.htm" target="_blank" onClick="window.open('example.15.2.htm','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">html</a>,
            <a href="example.15.2.txt" target="_blank" onClick="window.open('example.15.2.txt','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">txt</a>)
            </span></div>
                <p >При работе с <span class="texample">FileInputStream</span> метод <span class="texample">available()</span> практически наверняка вернет длину файла, то есть число байт, сколько вообще из него можно считать. Но не стоит закладываться на это при написании программ, которые должны устойчиво работать на различных платформах,– метод <span class="texample">available()</span> возвращает число байт, которое может быть на данный момент считано без блокирования. Тот факт, что, скорее всего, это число и будет длиной файла, является всего лишь частным случаем работы на некоторых платформах. </p>
                <p >В приведенном примере для наглядности закрытие <span class="keyword">потоков</span> производилось сразу же после окончания их использования в основном блоке. Однако лучше закрывать <span class="keyword">потоки</span> в <span class="texample">finally</span> блоке. </p>
                <div  class="example"><pre>
...
} finally {
try{inFile.close();}catch(IOException e){};
} 
</pre></div>
                <p >Такой подход гарантирует, что <span class="keyword">поток</span> будет закрыт и будут освобождены все связанные с ним системные ресурсы. </p>
            
            <h5 >PipedInputStream и PipedOutputStream</h5>
                
                <p >Классы <span class="texample">PipedInputStream</span> и <span class="texample">PipedOutputStream</span> характеризуются тем, что их объекты всегда используются в паре – к одному объекту <span class="texample">PipedInputStream</span> привязывается (подключается) один объект <span class="texample">PipedOutputStream</span>. Они могут быть полезны, если в программе необходимо организовать обмен данными между модулями (например, между <span class="keyword">потоками</span> выполнения). </p>
                <p >Эти классы применяются следующим образом: создается по объекту <span class="texample">PipedInputStream</span> и <span class="texample">PipedOutputStream</span>, после чего они могут быть соединены между собой. Один объект <span class="texample">PipedOutputStream</span> может быть соединен с ровно одним объектом <span class="texample">PipedInputStream</span>, и наоборот. Затем в объект <span class="texample">PipedOutputStream</span> записываются данные, после чего они могут быть считаны именно в подключенном объекте <span class="texample">PipedInputStream</span>. Такое соединение можно обеспечить либо вызовом метода <span class="texample">connect()</span> с передачей соответствующего объекта <span class="texample">PipedI/OStream</span> (будем так кратно обозначать пару классов, в данном случае <span class="texample">PipedInputStream</span> и <span class="texample">PipedOutputStream</span>), либо передать этот объект еще при вызове конструктора. </p>
                <p >Использование связки <span class="texample">PipedInputStream</span> и <span class="texample">PipedOutputStream</span> показано в следующем примере: </p>
                <a  name="example.15.3"></a><div  class="example"><span class="objectName">
            Пример 
            15.3.
            
            (<a href="example.15.3.htm" target="_blank" onClick="window.open('example.15.3.htm','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">html</a>,
            <a href="example.15.3.txt" target="_blank" onClick="window.open('example.15.3.txt','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">txt</a>)
            </span></div>
                <p >Данный пример носит чисто демонстративный характер (в результате его работы массив <span class="texample">toRead</span> будет заполнен случайными числами). Более явно выгода от использования <span class="texample">PipedI/OStream</span> в основном проявляется при разработке многопоточного приложения. Если в программе запускается несколько <span class="keyword">потоков</span> исполнения, организовать передачу данных между ними удобно с помощью этих классов. Для этого нужно создать связанные объекты <span class="texample">PipedI/OStream</span>, после чего передать ссылки на них в соответствующие <span class="keyword">потоки</span>. Поток выполнения, в котором производится чтение данных, может содержать подобный код: </p>
                <a  name="example.15.4"></a><div  class="example"><span class="objectName">
            Пример 
            15.4.
            
            (<a href="example.15.4.htm" target="_blank" onClick="window.open('example.15.4.htm','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">html</a>,
            <a href="example.15.4.txt" target="_blank" onClick="window.open('example.15.4.txt','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">txt</a>)
            </span></div>
                <p >Если с объектом <span class="texample">inStream</span> одновременно могут работать несколько <span class="keyword">потоков</span> выполнения, то необходимо использовать блок <span class="texample">synchronized</span> (как и сделано в примере), который гарантирует, что в период между вызовами <span class="texample">inStream.available()</span> и <span class="texample">inStream.read(…)</span> ни в каком другом <span class="keyword">потоке</span> выполнения не будет производиться считывание из <span class="texample">inStream</span>. Поэтому вызов <span class="texample">inStream.read(readedBytes)</span> не приведет к блокировке и все данные, готовые к считыванию, будут считаны. </p>
            
            <h5 >StringBufferInputStream</h5>
                
                <p >Иногда бывает удобно работать с текстовой строкой <span class="texample">String</span> как с <span class="keyword">потоком</span> байт. Для этого можно воспользоваться классом <span class="texample">StringBufferInputStream</span>. При создании объекта этого класса необходимо передать конструктору объект <span class="texample">String</span>. Данные, возвращаемые методом <span class="texample">read()</span>, будут считываться именно из этой строки. При этом символы будут преобразовываться в байты с потерей точности – старший байт отбрасывается (напомним, что символ char состоит из двух байт). </p>
            
            <h5 >SequenceInputStream</h5>
                
                <p >Класс <span class="texample">SequenceInputStream</span> объединяет <span class="keyword">поток данных</span> из других двух и более входных <span class="keyword">потоков</span>. Данные будут вычитываться последовательно – сначала все данные из первого <span class="keyword">потока</span> в списке, затем из второго, и так далее. Конец <span class="keyword">потока</span>
                    <span class="texample">SequenceInputStream</span> будет достигнут только тогда, когда будет достигнут конец <span class="keyword">потока</span>, последнего в списке. </p>
                <p >В этом классе имеется два конструктора – принимающий два <span class="keyword">потока</span> и принимающий <span class="texample">Enumeration</span> (в котором, конечно, должны быть только экземпляры <span class="texample">InputStream</span> и его наследников). Когда вызывается метод <span class="texample">read()</span>, <span class="texample">SequenceInputStream</span> пытается считать байт из текущего входного <span class="keyword">потока</span>. Если в нем больше данных нет (считанное из него значение равно <span class="texample">-1</span>), у него вызывается метод <span class="texample">close()</span> и следующий входной <span class="keyword">поток</span> становится текущим. Так продолжается до тех пор, пока не будут получены все данные из последнего <span class="keyword">потока</span>. Если при считывании обнаруживается, что больше входных <span class="keyword">потоков</span> нет, <span class="texample">SequenceInputStream</span> возвращает <span class="texample">-1</span>. Вызов метода <span class="texample">close()</span> у <span class="texample">SequenceInputStream</span> закрывает все содержащиеся в нем входные 
<span class="keyword">потоки</span>. </p>
                <p >Пример: </p>
                <a  name="example.15.5"></a><div  class="example"><span class="objectName">
            Пример 
            15.5.
            
            (<a href="example.15.5.htm" target="_blank" onClick="window.open('example.15.5.htm','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">html</a>,
            <a href="example.15.5.txt" target="_blank" onClick="window.open('example.15.5.txt','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">txt</a>)
            </span></div>
                <p >В результате выполнения этого примера в файл <span class="texample">file3.txt</span> будет записано содержимое файлов <span class="texample">file1.txt</span> и <span class="texample">file2.txt</span> – сначала полностью <span class="texample">file1.txt</span>, потом <span class="texample">file2.txt</span>. Закрытие <span class="keyword">потоков</span> производится в блоке <span class="texample">finally</span>. Поскольку при вызове метода <span class="texample">close()</span> может возникнуть <span class="texample">IOException</span>, необходим <span class="texample">try-catch</span> блок. Причем, каждый вызов метода <span class="texample">close()</span> взят в отдельный <span class="texample">try-catch</span> блок - для того, чтобы возникшее исключение при закрытии одного <span class="keyword">потока</span> не помешало закрытию другого. При этом нет необходимости закрывать <span class="keyword">потоки</span>
                    <span class="texample">inFile1</span> и <span class="texample">inFile2</span> – они будут автоматически закрыты при использовании в sequnceStream - либо когда в них закончатся данные, либо при вызове у <span class="texample">sequenceStream</span> метода <span class="texample">close()</span>. </p>
                <p >Объект <span class="texample">SequenceInputStream</span> можно было создать и другим способом: сначала получить объект <span class="texample">Enumeration</span>, содержащий все <span class="keyword">потоки</span>, и передать его в конструктор <span class="texample">SequenceInputStream</span>: </p>
                <a  name="example.15.6"></a><div  class="example"><span class="objectName">
            Пример 
            15.6.
            
            (<a href="example.15.6.htm" target="_blank" onClick="window.open('example.15.6.htm','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">html</a>,
            <a href="example.15.6.txt" target="_blank" onClick="window.open('example.15.6.txt','','menubar=no,scrollbars=yes,resizable=yes');return false;" class="objectName">txt</a>)
            </span></div>
                <p >Если заменить в предыдущем примере инициализацию <span class="texample">sequenceStream</span> на приведенную здесь, то в файл <span class="texample">file3.txt</span>, кроме содержимого файлов <span class="texample">file1.txt</span> и <span class="texample">file2.txt</span>, будут записаны еще три строки – одна в начале файла, одна между содержимым файлов <span class="texample">file1.txt</span> и <span class="texample">file2.txt</span> и еще одна в конце <span class="texample">file3.txt</span>. </p>
            


    
	</td>		
	</tr>
	<tr><td height="8" colspan=2><img src="../../../img/empty.gif" width="1" height="8"></td></tr>

	<tr><td height="8" colspan=2><img src="../../../img/empty.gif" width="1" height="8"></td></tr>
	<tr><td colspan=2 align="center">

<a href="2.html" class="attention">Перейти к следующей странице &raquo;</b></a>

	</td></tr>
	<tr><td height="16" colspan=2><img src="../../../img/empty.gif" width="1" height="16"></td></tr>

<tr><td align="center" class="orang_light" colspan="2">
&nbsp;
<font class="rtxt">Если Вы заметили ошибку на этой странице - <a class="llecture_red" target="_blank" href="http://www.intuit.ru/help/askform.xhtml?course=57&url=http://www.intuit.ru/department/pl/javapl/15/1.html">сообщите нам.</a></font>
&nbsp;
</td></tr>

	<tr><td height="2" colspan=2><img src="../../../img/empty.gif" width="1" height="2"></td></tr>
<tr>

<td align=left><font class="rtitle">Страницы:</font>


<font class="rtitle">1</font>

<font class="stitle">|</font>


<a class="rtitle" href="2.html">2</a>
<font class="stitle">|</font>


<a class="rtitle" href="3.html">3</a>
<font class="stitle">|</font>


<a class="rtitle" href="4.html">4</a>
<font class="stitle">|</font>


<a class="rtitle" href="http://www.intuit.ru/department/pl/javapl/15/test/">вопросы</a> <font class="stitle">|</font> 
<a class="rtitle" href="2.html"><b>&raquo;</b></a>
</td>
<td align=right><font class="stitle">|</font>
<a href="http://www.intuit.ru/department/pl/javapl/15/javapl_15.html" class="rtitle" target="_blank">HTML для печати</a>




</td>

</tr>

	<tr><td height="8" colspan=2><img src="../../../img/empty.gif" width="1" height="8"></td></tr>
	<tr><td class="orang" height="1" colspan=2><img src="../../../img/empty.gif" width="1" height="1"></td></tr>
	</table>
	<!-- /content -->

</td>
<td width="6"><img src="../../../img/empty.gif" width="6"></td>
<td width="1" class="gray"><img src="../../../img/empty.gif"></td>
<td width="6"><img src="../../../img/empty.gif" width="6"></td>
<td width="180">
	<!-- rightcolumn -->
	<table border="0" cellpadding="2" cellspacing="0" background="" width="100%">
	<!---->


<!--Основные понятия-->
	<td class="bordo" height="24">&nbsp;&nbsp;Ключевые слова</td>
	</tr>
	<tr>
	<td><span class="rtxt"><span  class="keyword_list_def">stream</span>, <span  class="keyword_list_def">поток данных</span><br ><br ><a  class="allnews" href="../keywords.html">все ключевые слова »</a>
</td>
	</tr>
	<tr><td>&nbsp;</td></tr>
<!--/Основные понятия-->

		<tr><td class="bordo" height="24">&nbsp;&nbsp;Информация о лекции</td></tr>
	<tr>
	<td>
<span class="rtxt">Эта лекция описывает реализованные в Java возможности передачи информации, что является важной функцией для большинства программных систем. Сюда входит работа с файлами, сетью, долговременное сохранение объектов, обмен данными между потоками исполнения и т.п. Все эти действия базируются на потоках байт (представлены классами InputStream и OutputStream) и потоках символов (Reader и Writer). В библиотеке java.io содержатся все эти классы и их многочисленные наследники, предоставляющие полезные возможности. Отдельно рассматривается механизм сериализации объектов и работа с файлами.

	</td>
	</tr>
	<tr><td>&nbsp;</td></tr>

	

	
	<td class="bordo" height="24">&nbsp;&nbsp;Учебники к курсу</td>
	</tr>
	<tr>
<td>

		<table border="0" cellpadding="0" cellspacing="0">


		<tr valign="top">
		<td>

<table border="0" cellpadding="1" cellspacing="0"  align="left" hspace="5" vspace="2"><tr><td class="orang"><table border="0" cellpadding="2" cellspacing="0" bgcolor="#ffffff"><tr><td valign="middle" align="center"><a href="http://www.intuit.ru/shop/catalog/product.xhtml?id=2459325"><img width="72" height="105" src="../../../img/covers/i/in/int/intu006.jpg" alt="Программирование на Java" border="0"></a></td></tr></table></td></tr></table>

<a href="http://www.intuit.ru/shop/catalog/product.xhtml?id=2459325" class="spectitle">
Программирование на Java</a>
<br>
<font class="spectxt">
Вязовик Н.А.,
<br>
Интернет-университет информационных технологий - ИНТУИТ.ру.
<br>
Курс лекций посвящен современному и мощному языку программирования Java. В его рамках дается вводное изложение принципов ООП, необходимое для разработки на Java, основы языка, библиотеки для работы с файлами, сетью, для построения оконного интерфейса пользователя (GUI) и др.

</font>
		</td>
		</tr>

		</table>

</td>
	</tr>


	<tr><td height="10"><img src="../../../img/empty.gif" width="1" height="10"></td></tr>



	<tr>
<td>
		<table border="0" cellpadding="0" cellspacing="0">


		<tr valign="top">
		<td class="spectxt">
<span class="spectitle"><a href="http://www.intuit.ru/shop/catalog/product.xhtml?id=1412049" class="spectitle">Приемы объектно-ориентированного проектирования. Паттерны проектирования</a></span>
<br>
Гамма Э. и др.,
Питер.
		</td>
		</tr>


		</table>

</td>
	</tr>


<tr>
<td><a href="http://www.intuit.ru/cgi-bin/goto.fcgi?mode=books_of_course&cid=57" class="allnews">все книги по курсу &raquo;</a></td>
</tr>



	</table>
	<!-- /rightcolumn -->
</td>
<td width="6"><img src="../../../img/empty.gif" width="6"></td>
</tr>
</table>

<!-- /bottom -->
<table border="0" cellpadding="0" cellspacing="6" width="100%" height="73">
<tr>
<td align="center" class="menu">
    <table border="0" cellpadding="0" cellspacing="0" background="">
    <tr>
    <td class="copy">
    <a href="http://www.intuit.ru/all_departments.html" class="bot">Кафедры</a> |
    <a href="http://www.intuit.ru/all_courses.html" class="bot">Все курсы</a> |
    <a href="http://www.intuit.ru/syllabus.html" class="bot">Расписание</a> |
    <a href="http://www.intuit.ru/shop/catalog/index.html?" class="bot">Учебники</a> | 
    <a href="http://www.intuit.ru/news.html" class="bot">Новости</a> | 
    <a href="http://www.intuit.ru/department/forum/" class="bot">Форум</a>
    <br>
    <a href="http://www.intuit.ru/user/classes/" class="bot">Мои курсы</a> | 
    <a href="http://www.intuit.ru/user/adjustments/" class="bot">Личные настройки</a> | 
    <a href="http://www.intuit.ru/user/cart/" class="bot">Корзина</a> | 
    <a href="http://www.intuit.ru/help/" class="bot">Помощь</a><br><br>
    Телефон: (095) 253-9312, 253-9313, факс: (095) 253-9310, email: <a href="http://www.intuit.ru/help/askform.xhtml" class="bot">info@intuit.ru</a><br>
    Адрес: 123056 Москва, Электрический пер., 8, стр. 3<br>
    &copy; 2003-2004 INTUIT.ru. Все права защищены.
    </td>
    </tr>
    </table>
</td>
</tr>
</table>
<!-- /bottom -->


</body>
</html>
